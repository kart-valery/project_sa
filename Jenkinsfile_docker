pipeline {
   agent any
   stages {
    stage('Install docker with parametr') {
      steps {
            sh 'sshpass -p "${PASS}" ssh -o StrictHostKeyChecking=no root@${HOST}'
            sh 'apt install sudo -y'
            sh 'sudo apt-get update -y'
            sh 'sudo apt-get -y install apt-transport-https ca-certificates curl gnupg lsb-release'
            sh 'sudo apt-get update'
            sh 'sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose -y'
            git url: 'https://github.com/kart-valery/project_sa.git', branch: 'main', credentialsId: 'kart_git_hub'
            sh 'mkdir -p /home/old/db'
            sh 'mkdir -p /home/old/html'
            sh 'sudo chown -R jenkins:jenkins /home/old'
            sh 'mkdir -p /data/docker/db'
            sh 'mkdir -p /data/docker/html'
            sh 'cp ./docker/docker-compose.yml /data/docker/docker-compose.yml'
            sh 'sudo chown -R jenkins:jenkins /data/docker'
            sh 'cd /data/docker/'
            sh 'ls -la'
            sh 'docker-compose up -d'
            }
    }

}
    post {
        always {
            deleteDir()
        }
    
  }
}
